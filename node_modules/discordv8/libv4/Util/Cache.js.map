{"version":3,"sources":["../../src/Util/Cache.js"],"names":["discrimS","Symbol","discrimCacheS","Cache","discrim","limit","key","value","valid","constructor","name","item","test","get","found","add","data","cacheKey","length","splice","push","old","obj","hasOwnProperty","Math","floor","random","i","Array"],"mappings":"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","file":"Cache.js","sourcesContent":["\"use strict\";\n\nvar discrimS = Symbol();\nvar discrimCacheS = Symbol();\n\nexport default class Cache extends Array {\n\tconstructor(discrim, limit) {\n\t\tsuper();\n\t\tthis[discrimS] = discrim || \"id\";\n\t\tthis[discrimCacheS] = {};\n\t\tthis.limit = limit;\n\t}\n\n\tget(key, value) {\n\t\tif (typeof key === 'function') {\n\t\t\tvar valid = key;\n\t\t\tkey = null;\n\t\t} else if (key && !value) {\n\t\t\treturn this[discrimCacheS][key] || null;\n\t\t} else if (key === this[discrimS] && typeof value === \"string\") {\n\t\t\treturn this[discrimCacheS][value] || null;\n\t\t} else if (value && value.constructor.name === 'RegExp') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn value.test(item);\n\t\t\t}\n\t\t} else if (typeof value !== 'function') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn item == value;\n\t\t\t}\n\t\t}\n\n\t\tfor (var item of this) {\n\t\t\tif (valid(key == null ? item : item[key])) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thas(key, value) {\n\t\treturn !!this.get(key, value);\n\t}\n\n\tgetAll(key, value) {\n\t\tvar found = new Cache(this[discrimS]);\n\n\t\tif (typeof key === 'function') {\n\t\t\tvar valid = key;\n\t\t\tkey = null;\n\t\t} else if (value && value.constructor.name === 'RegExp') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn value.test(item);\n\t\t\t}\n\t\t} else if (typeof value !== 'function') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn item == value;\n\t\t\t}\n\t\t}\n\n\t\tfor (var item of this) {\n\t\t\tif (valid(key == null ? item : item[key])) {\n\t\t\t\tfound.add(item);\n\t\t\t}\n\t\t}\n\n\t\treturn found;\n\t}\n\n\tadd(data) {\n\t\tvar cacheKey = data[this[discrimS]];\n\t\tif (this[discrimCacheS][cacheKey]) {\n\t\t\treturn this[discrimCacheS][cacheKey];\n\t\t}\n\t\tif (this.limit && this.length >= this.limit) {\n\t\t\tthis.splice(0, 1);\n\t\t}\n\t\tthis.push(data);\n\t\tthis[discrimCacheS][cacheKey] = data;\n\t\treturn data;\n\t}\n\n\tupdate(old, data) {\n\t\tvar obj = this[discrimCacheS][old[this[discrimS]]];\n        if (obj) {\n\t\t\tfor (var key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tobj[key] = data[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\t\treturn false;\n\t}\n\n\trandom() {\n\t\treturn this[Math.floor(Math.random()*this.length)];\n\t}\n\n\tremove(data) {\n\t\tif(!this[discrimCacheS][data[this[discrimS]]]) return false;\n\n\t\tdelete this[discrimCacheS][data[this[discrimS]]];\n\t\tfor (var i in this) {\n\t\t\tif (this[i] && this[i][this[discrimS]] === data[this[discrimS]]) {\n\t\t\t\tthis.splice(i, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n"]}