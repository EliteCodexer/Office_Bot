{"version":3,"sources":["../../src/Structures/Role.js"],"names":["DefaultRole","createInstantInvite","readMessages","readMessageHistory","sendMessages","sendTTSMessages","embedLinks","attachFiles","mentionEveryone","voiceConnect","voiceSpeak","voiceUseVAD","reduce","previous","current","Role","data","server","client","position","permissions","name","managed","id","hoist","color","mentionable","keys","obj","k","explicit","hp","perm","hasPermission","kickMembers","banMembers","manageRoles","manageChannels","manageServer","administrator","manageMessages","voiceMuteMembers","voiceDeafenMembers","voiceMoveMembers","serialise","String","permission","value","forEach","setPermission","val","toString","length","deleteRole","apply","arguments","updateRole","member","callback","addMemberToRole","addUserToRole","removeMemberFromRole","removeUserFromRole","mention","Date"],"mappings":"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","file":"Role.js","sourcesContent":["\"use strict\";\nimport {Permissions} from \"../Constants\";\nimport {reg} from \"../Util/ArgumentRegulariser\";\n/*\n\nexample data\n\n{ position: -1,\n    permissions: 36953089,\n    name: '@everyone',\n    managed: false,\n    id: '110007368451915776',\n    hoist: false,\n    color: 0 }\n*/\n\nconst DefaultRole = [\n\tPermissions.createInstantInvite,\n\tPermissions.readMessages,\n\tPermissions.readMessageHistory,\n\tPermissions.sendMessages,\n\tPermissions.sendTTSMessages,\n\tPermissions.embedLinks,\n\tPermissions.attachFiles,\n\tPermissions.readMessageHistory,\n\tPermissions.mentionEveryone,\n\tPermissions.voiceConnect,\n\tPermissions.voiceSpeak,\n\tPermissions.voiceUseVAD\n].reduce( (previous, current) => previous | current, 0 );\n\nexport default class Role {\n\tconstructor(data, server, client){\n\t\tthis.position = data.position || -1;\n\t\tthis.permissions = data.permissions || (data.name === \"@everyone\" ? DefaultRole : 0 );\n\t\tthis.name = data.name || \"@everyone\";\n\t\tthis.managed = data.managed || false;\n\t\tthis.id = data.id;\n\t\tthis.hoist = data.hoist || false;\n\t\tthis.color = data.color || 0;\n\t\tthis.server = server;\n\t\tthis.client = client;\n\t\tthis.mentionable = data.mentionable || false;\n\t}\n\n\tget createdAt() {\n\t\treturn new Date((+this.id / 4194304) + 1420070400000);\n\t}\n\n\ttoObject() {\n\t\tlet keys = ['id', 'position', 'permissions', 'name', 'managed', 'hoist', 'color', 'mentionable'],\n\t\t\tobj = {};\n\n\t\tfor (let k of keys) {\n\t\t\tobj[k] = this[k];\n\t\t}\n\t\t\n\t\treturn obj;\n\t}\n\n\tserialise(explicit){\n\n\t\tvar hp = (perm) => this.hasPermission(perm, explicit);\n\n\t\treturn {\n\t\t\t// general\n\t\t\tcreateInstantInvite : hp( Permissions.createInstantInvite ),\n\t\t\tkickMembers : hp( Permissions.kickMembers ),\n\t\t\tbanMembers : hp( Permissions.banMembers ),\n\t\t\tmanageRoles : hp ( Permissions.manageRoles ),\n\t\t\tmanageChannels : hp( Permissions.manageChannels ),\n\t\t\tmanageServer : hp( Permissions.manageServer ),\n\t\t\tadministrator: hp( Permissions.administrator ),\n\t\t\t// text\n\t\t\treadMessages : hp( Permissions.readMessages ),\n\t\t\tsendMessages : hp( Permissions.sendMessages ),\n\t\t\tsendTTSMessages : hp( Permissions.sendTTSMessages ),\n\t\t\tmanageMessages : hp( Permissions.manageMessages ),\n\t\t\tembedLinks : hp( Permissions.embedLinks ),\n\t\t\tattachFiles : hp( Permissions.attachFiles ),\n\t\t\treadMessageHistory : hp( Permissions.readMessageHistory ),\n\t\t\tmentionEveryone : hp( Permissions.mentionEveryone ),\n\t\t\t// voice\n\t\t\tvoiceConnect : hp( Permissions.voiceConnect ),\n\t\t\tvoiceSpeak : hp( Permissions.voiceSpeak ),\n\t\t\tvoiceMuteMembers : hp( Permissions.voiceMuteMembers ),\n\t\t\tvoiceDeafenMembers : hp( Permissions.voiceDeafenMembers ),\n\t\t\tvoiceMoveMembers : hp( Permissions.voiceMoveMembers ),\n\t\t\tvoiceUseVAD : hp( Permissions.voiceUseVAD )\n\t\t};\n\t}\n\n\tserialize(){\n\t\t// ;n;\n\t\treturn this.serialise();\n\t}\n\n\thasPermission(perm, explicit=false){\n\t\tif( perm instanceof String || typeof perm === \"string\" ){\n\t\t\tperm = Permissions[perm];\n\t\t}\n\t\tif(!perm){\n\t\t\treturn false;\n\t\t}\n\t\tif(!explicit){ // implicit permissions allowed\n\t\t\tif( !!(this.permissions & Permissions.administrator) ){\n\t\t\t\t// manageRoles allowed, they have all permissions\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t// e.g.\n\t\t// !!(36953089 & Permissions.manageRoles) = not allowed to manage roles\n\t\t// !!(36953089 & (1 << 21)) = voice speak allowed\n\n\t\treturn !!(this.permissions & perm);\n\t}\n\n\tsetPermission(permission, value){\n\t\tif( permission instanceof String || typeof permission === \"string\" ){\n\t\t\tpermission = Permissions[permission];\n\t\t}\n\t\tif(permission){\n\t\t\t// valid permission\n\t\t\tif(value){\n\t\t\t\tthis.permissions |= permission;\n\t\t\t}else{\n\t\t\t\tthis.permissions &= ~permission;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPermissions(obj){\n\t\tobj.forEach((value, permission) => {\n\t\t\tif( permission instanceof String || typeof permission === \"string\" ){\n\t\t\t\tpermission = Permissions[permission];\n\t\t\t}\n\t\t\tif(permission){\n\t\t\t\t// valid permission\n\t\t\t\tthis.setPermission(permission, value);\n\t\t\t}\n\t\t});\n\t}\n\n\tcolorAsHex(){\n\t\tvar val = this.color.toString(16);\n\t\twhile(val.length < 6){\n\t\t\tval = \"0\" + val;\n\t\t}\n\t\treturn \"#\"+val;\n\t}\n\n\tdelete() {\n\t\treturn this.client.deleteRole.apply(this.client, reg(this, arguments));\n\t}\n\n\tedit() {\n\t\treturn this.client.updateRole.apply(this.client, reg(this, arguments));\n\t}\n\n\tupdate() {\n\t\treturn this.client.updateRole.apply(this.client, reg(this, arguments));\n\t}\n\n\taddMember(member, callback) {\n\t\treturn this.client.addMemberToRole.apply(this.client, [member, this, callback]);\n\t}\n\n\taddUser(member, callback) {\n\t\treturn this.client.addUserToRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tremoveMember(member, callback) {\n\t\treturn this.client.removeMemberFromRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tremoveUser(member, callback) {\n\t\treturn this.client.removeUserFromRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tmention(){\n\t\tif(this.mentionable)\n\t\t\treturn `<@&${this.id}>`;\n\t\treturn this.name;\n\t}\n\n\ttoString(){\n\t\treturn this.mention();\n\t}\n}\n"]}