{"version":3,"sources":["../../src/Structures/Server.js"],"names":["strictKeys","Server","data","client","id","owner_id","internal","buckets","region","ownerID","name","members","channels","roles","emojis","icon","afkTimeout","afk_timeout","afkChannelID","afk_channel_id","memberMap","memberCount","member_count","large","forEach","role","add","dataRole","emoji","dataEmoji","member","dataUser","user","mute","selfMute","self_mute","deaf","selfDeaf","self_deaf","joinedAt","Date","parse","joined_at","nick","users","channel","dataChannel","type","presences","presence","get","status","game","voice_states","options","bot","voiceState","user_id","undefined","channel_id","eventVoiceJoin","emit","pendingVoiceStates","keys","obj","k","map","toObject","resolver","resolveUser","result","pid","detailsOf","rolesOfUser","oldChannel","eventVoiceLeave","voiceChannel","oldState","getAll","chan","has","remove","server","key","leaveServer","apply","arguments","createInvite","createRole","tlength","callback","banMember","unbanMember","kickMember","getBans","createChannel","setNickname","filter","m","hasRole","membersWithRole","c","webhooks","reduce","previousChannel","currentChannel","webhook","SERVER_ICON","defaultChannel"],"mappings":"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","file":"Server.js","sourcesContent":["\"use strict\";\n\n/**\n * Types of region for a server, include: `us-west`, `us-east`, `us-south`, `us-central`, `singapore`, `london`, `sydney`, `amsterdam` and `frankfurt`\n * @typedef {(string)} region\n */\n\nimport Bucket from \"../Util/Bucket\";\nimport Equality from \"../Util/Equality\";\nimport {Endpoints} from \"../Constants\";\nimport Cache from \"../Util/Cache\";\nimport User from \"./User\";\nimport TextChannel from \"./TextChannel\";\nimport VoiceChannel from \"./VoiceChannel\";\nimport Role from \"./Role\";\nimport Emoji from \"./Emoji\";\nimport {reg} from \"../Util/ArgumentRegulariser\";\n\nvar strictKeys = [\n\t\"region\", \"ownerID\", \"name\", \"id\", \"icon\", \"afkTimeout\", \"afkChannelID\"\n];\n\nexport default class Server extends Equality {\n\n\tconstructor(data, client) {\n\n\t\tsuper();\n\n\t\tthis.client = client;\n\t\tthis.id = data.id;\n\n\t\tif(data.owner_id) { // new server data\n\t\t    client.internal.buckets[\"bot:msg:guild:\" + this.id] = new Bucket(5, 5000);\n            client.internal.buckets[\"dmsg:\" + this.id] = new Bucket(5, 1000);\n            client.internal.buckets[\"bdmsg:\" + this.id] = new Bucket(1, 1000);\n            client.internal.buckets[\"guild_member:\" + this.id] = new Bucket(10, 10000);\n            client.internal.buckets[\"guild_member_nick:\" + this.id] = new Bucket(1, 1000);\n        }\n\n\t\tthis.region = data.region;\n\t\tthis.ownerID = data.owner_id || data.ownerID;\n\t\tthis.name = data.name;\n\t\tthis.members = new Cache();\n\t\tthis.channels = new Cache();\n\t\tthis.roles = new Cache();\n\t\tthis.emojis = new Cache();\n\t\tthis.icon = data.icon;\n\t\tthis.afkTimeout = data.afk_timeout;\n\t\tthis.afkChannelID = data.afk_channel_id || data.afkChannelID;\n\t\tthis.memberMap = data.memberMap || {};\n\t\tthis.memberCount = data.member_count || data.memberCount;\n\t\tthis.large = data.large || this.memberCount > 250;\n\n\t\tif (data.roles instanceof Cache) {\n\t\t\tdata.roles.forEach((role) => this.roles.add(role));\n\t\t} else {\n\t\t\tdata.roles.forEach((dataRole) => {\n\t\t\t\tthis.roles.add(new Role(dataRole, this, client));\n\t\t\t});\n\t\t}\n\n\t\tif (data.emojis instanceof Cache) {\n\t\t\tdata.emojis.forEach((emoji) => this.emojis.add(emoji));\n\t\t} else {\n\t\t\tdata.emojis.forEach((dataEmoji) => {\n\t\t\t\tthis.emojis.add(new Emoji(dataEmoji, this));\n\t\t\t})\n\t\t}\n\n\t\tif (data.members instanceof Cache) {\n\t\t\tdata.members.forEach((member) => this.members.add(member));\n\t\t} else {\n\t\t\tdata.members.forEach((dataUser) => {\n\t\t\t\tthis.memberMap[dataUser.user.id] = {\n\t\t\t\t\troles: dataUser.roles,\n\t\t\t\t\tmute: dataUser.mute,\n\t\t\t\t\tselfMute: dataUser.self_mute,\n\t\t\t\t\tdeaf: dataUser.deaf,\n\t\t\t\t\tselfDeaf: dataUser.self_deaf,\n\t\t\t\t\tjoinedAt: Date.parse(dataUser.joined_at),\n\t\t\t\t\tnick: dataUser.nick || null\n\t\t\t\t};\n\t\t\t\tthis.members.add(client.internal.users.add(new User(dataUser.user, client)));\n\t\t\t});\n\t\t}\n\n\t\tif (data.channels instanceof Cache) {\n\t\t\tdata.channels.forEach((channel) => this.channels.add(channel));\n\t\t} else {\n\t\t\tdata.channels.forEach((dataChannel) => {\n\t\t\t\tif (dataChannel.type === 0) {\n\t\t\t\t\tthis.channels.add(client.internal.channels.add(new TextChannel(dataChannel, client, this)));\n\t\t\t\t} else {\n\t\t\t\t\tthis.channels.add(client.internal.channels.add(new VoiceChannel(dataChannel, client, this)));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (data.presences) {\n\t\t\tfor (var presence of data.presences) {\n\t\t\t\tvar user = client.internal.users.get(\"id\", presence.user.id);\n\t\t\t\tif(user) {\n\t\t\t\t\tuser.status = presence.status;\n\t\t\t\t\tuser.game = presence.game;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.voice_states) {\n\t\t\tif(this.client.options.bot) {\n\t\t\t\tfor (var voiceState of data.voice_states) {\n\t\t\t\t\tlet user = this.members.get(\"id\", voiceState.user_id);\n\t\t\t\t\tif (user) {\n\t\t\t\t\t\tthis.memberMap[user.id] = this.memberMap[user.id] || {};\n\t\t\t\t\t\tthis.memberMap[user.id].mute = voiceState.mute || this.memberMap[user.id].mute;\n\t\t\t\t\t\tthis.memberMap[user.id].selfMute = voiceState.self_mute === undefined ? this.memberMap[user.id].selfMute : voiceState.self_mute;\n\t\t\t\t\t\tthis.memberMap[user.id].deaf = voiceState.deaf || this.memberMap[user.id].deaf;\n\t\t\t\t\t\tthis.memberMap[user.id].selfDeaf = voiceState.self_deaf === undefined ? this.memberMap[user.id].selfDeaf : voiceState.self_deaf;\n\t\t\t\t\t\tlet channel = this.channels.get(\"id\", voiceState.channel_id);\n\t\t\t\t\t\tif (channel) {\n\t\t\t\t\t\t\tthis.eventVoiceJoin(user, channel);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.client.emit(\"warn\", \"channel doesn't exist even though READY expects them to\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.client.emit(\"warn\", \"user doesn't exist even though READY expects them to\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.pendingVoiceStates = data.voice_states;\n\t\t\t}\n\t\t}\n\t}\n\n\tget webhooks() {\n\t\treturn this.channels\n\t\t\t.map(c => c.webhooks)\n\t\t\t.reduce((previousChannel, currentChannel) => {\n\t\t\t\tif (currentChannel) {\n\t\t\t\t\tcurrentChannel.forEach(webhook => {\n\t\t\t\t\t\tpreviousChannel.add(webhook);\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn previousChannel;\n\t\t\t}, new Cache(\"id\"));\n\t}\n\n\tget createdAt() {\n\t\treturn new Date((+this.id / 4194304) + 1420070400000);\n\t}\n\n\ttoObject() {\n\t\tvar keys = ['id', 'name', 'region', 'ownerID', 'icon', 'afkTimeout', 'afkChannelID', 'large', 'memberCount'],\n\t\t\tobj = {};\n\n\t\tfor (let k of keys) {\n\t\t\tobj[k] = this[k];\n\t\t}\n\n\t\tobj.members = this.members.map(member => member.toObject());\n\t\tobj.channels = this.channels.map(channel => channel.toObject());\n\t\tobj.roles = this.roles.map(role => role.toObject());\n\t\tobj.emojis = this.emojis.map(emoji => emoji.toObject());\n\n\t\treturn obj;\n\t}\n\n\tdetailsOf(user) {\n\t\tuser = this.client.internal.resolver.resolveUser(user);\n\t\tif (user) {\n\t\t\tvar result = this.memberMap[user.id] || {};\n\t\t\tif(result && result.roles) {\n\t\t\t\tresult.roles = result.roles.map(pid => this.roles.get(\"id\", pid) || pid);\n\t\t\t}\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t}\n\n\tdetailsOfUser(user) {\n\t\treturn this.detailsOf(user);\n\t}\n\n\tdetailsOfMember(user) {\n\t\treturn this.detailsOf(user);\n\t}\n\n\tdetails(user) {\n\t\treturn this.detailsOf(user);\n\t}\n\n\trolesOfUser(user) {\n\t\treturn this.detailsOf(user).roles || [];\n\t}\n\n\trolesOfMember(member) {\n\t\treturn this.rolesOfUser(member);\n\t}\n\n\trolesOf(user) {\n\t\treturn this.rolesOfUser(user);\n\t}\n\n\tget iconURL() {\n\t\tif (!this.icon) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn Endpoints.SERVER_ICON(this.id, this.icon);\n\t\t}\n\t}\n\n\tget afkChannel() {\n\t\treturn this.channels.get(\"id\", this.afkChannelID);\n\t}\n\n\tget defaultChannel() {\n\t\treturn this.channels.get(\"id\", this.id);\n\t}\n\n\tget generalChannel() {\n\t\treturn this.defaultChannel;\n\t}\n\n\tget general() {\n\t\treturn this.defaultChannel;\n\t}\n\n\tget owner() {\n\t\treturn this.members.get(\"id\", this.ownerID);\n\t}\n\n\ttoString() {\n\t\treturn this.name;\n\t}\n\n\teventVoiceJoin(user, channel) {\n\t\t// removes from other speaking channels first\n\t\tvar oldChannel = this.eventVoiceLeave(user);\n\n\t\tchannel.members.add(user);\n\t\tuser.voiceChannel = channel;\n\n\t\tif (oldChannel.id && channel.id !== oldChannel.id) {\n\t\t\tthis.client.emit(\"voiceLeave\", oldChannel, user);\n\t\t\tthis.client.emit(\"voiceSwitch\", oldChannel, channel, user);\n\t\t}\n\n\t\tthis.client.emit(\"voiceJoin\", channel, user);\n\t}\n\n\teventVoiceStateUpdate(channel, user, data) {\n\t\tif (!user.voiceChannel || user.voiceChannel.id !== channel.id) {\n\t\t\treturn this.eventVoiceJoin(user, channel);\n\t\t}\n\t\tif (!this.memberMap[user.id]) {\n\t\t\tthis.memberMap[user.id] = {};\n\t\t}\n\t\tvar oldState = {\n\t\t\tmute: this.memberMap[user.id].mute,\n\t\t\tselfMute: this.memberMap[user.id].self_mute,\n\t\t\tdeaf: this.memberMap[user.id].deaf,\n\t\t\tselfDeaf: this.memberMap[user.id].self_deaf\n\t\t};\n\t\tthis.memberMap[user.id].mute = data.mute;\n\t\tthis.memberMap[user.id].selfMute = data.self_mute;\n\t\tthis.memberMap[user.id].deaf = data.deaf;\n\t\tthis.memberMap[user.id].selfDeaf = data.self_deaf;\n\t\tif (oldState.mute !== undefined && (oldState.mute != data.mute || oldState.self_mute != data.self_mute\n\t\t\t|| oldState.deaf != data.deaf || oldState.self_deaf != data.self_deaf)) {\n\t\t\tthis.client.emit(\"voiceStateUpdate\", channel, user, oldState, this.memberMap[user.id]);\n\t\t} else {\n\t\t\tthis.eventVoiceJoin(user, channel);\n\t\t}\n\t}\n\n\teventVoiceLeave(user) {\n\t\tfor (let chan of this.channels.getAll(\"type\", 2)) {\n\t\t\tif (chan.members.has(\"id\", user.id)) {\n\t\t\t\tchan.members.remove(user);\n\t\t\t\tuser.voiceChannel = null;\n\t\t\t\treturn chan;\n\t\t\t}\n\t\t}\n\t\treturn {server: this};\n\t}\n\n\tequalsStrict(obj) {\n\t\tif (obj instanceof Server) {\n\t\t\tfor (var key of strictKeys) {\n\t\t\t\tif (obj[key] !== this[key]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tleave() {\n\t\treturn this.client.leaveServer.apply(this.client, reg(this, arguments));\n\t}\n\n\tdelete() {\n\t\treturn this.client.leaveServer.apply(this.client, reg(this, arguments));\n\t}\n\n\tcreateInvite() {\n\t\treturn this.client.createInvite.apply(this.client, reg(this, arguments));\n\t}\n\n\tcreateRole() {\n\t\treturn this.client.createRole.apply(this.client, reg(this, arguments));\n\t}\n\n\tbanMember(user, tlength, callback) {\n\t\treturn this.client.banMember.apply(this.client, [user, this, tlength, callback]);\n\t}\n\n\tbanUser(user, tlength, callback) {\n\t\treturn this.client.banMember.apply(this.client, [user, this, tlength, callback]);\n\t}\n\n\tban(user, tlength, callback) {\n\t\treturn this.client.banMember.apply(this.client, [user, this, tlength, callback]);\n\t}\n\n\tunbanMember(user, callback) {\n\t\treturn this.client.unbanMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tunbanUser(user, callback) {\n\t\treturn this.client.unbanMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tunban(user, callback) {\n\t\treturn this.client.unbanMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tkickMember(user, callback) {\n\t\treturn this.client.kickMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tkickUser(user, callback) {\n\t\treturn this.client.kickMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tkick(user, callback) {\n\t\treturn this.client.kickMember.apply(this.client, [user, this, callback]);\n\t}\n\n\tgetBans() {\n\t\treturn this.client.getBans.apply(this.client, reg(this, arguments));\n\t}\n\n\tcreateChannel() {\n\t\treturn this.client.createChannel.apply(this.client, reg(this, arguments));\n\t}\n\n\tsetNickname() {\n\t\treturn this.client.setNickname.apply(this.client, reg(this, arguments));\n\t}\n\n\tmembersWithRole(role) {\n\t\treturn this.members.filter(m => m.hasRole(role));\n\t}\n\n\tusersWithRole(role) {\n\t\treturn this.membersWithRole(role);\n\t}\n}\n"]}