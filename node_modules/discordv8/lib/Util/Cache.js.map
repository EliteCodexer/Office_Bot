{"version":3,"sources":["../../src/Util/Cache.js"],"names":["discrimS","Symbol","discrimCacheS","Cache","Array","constructor","discrim","limit","get","key","value","valid","name","item","test","has","getAll","found","add","data","cacheKey","length","splice","push","update","old","obj","hasOwnProperty","random","Math","floor","remove","i"],"mappings":"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","file":"Cache.js","sourcesContent":["\"use strict\";\n\nvar discrimS = Symbol();\nvar discrimCacheS = Symbol();\n\nexport default class Cache extends Array {\n\tconstructor(discrim, limit) {\n\t\tsuper();\n\t\tthis[discrimS] = discrim || \"id\";\n\t\tthis[discrimCacheS] = {};\n\t\tthis.limit = limit;\n\t}\n\n\tget(key, value) {\n\t\tif (typeof key === 'function') {\n\t\t\tvar valid = key;\n\t\t\tkey = null;\n\t\t} else if (key && !value) {\n\t\t\treturn this[discrimCacheS][key] || null;\n\t\t} else if (key === this[discrimS] && typeof value === \"string\") {\n\t\t\treturn this[discrimCacheS][value] || null;\n\t\t} else if (value && value.constructor.name === 'RegExp') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn value.test(item);\n\t\t\t}\n\t\t} else if (typeof value !== 'function') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn item == value;\n\t\t\t}\n\t\t}\n\n\t\tfor (var item of this) {\n\t\t\tif (valid(key == null ? item : item[key])) {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thas(key, value) {\n\t\treturn !!this.get(key, value);\n\t}\n\n\tgetAll(key, value) {\n\t\tvar found = new Cache(this[discrimS]);\n\n\t\tif (typeof key === 'function') {\n\t\t\tvar valid = key;\n\t\t\tkey = null;\n\t\t} else if (value && value.constructor.name === 'RegExp') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn value.test(item);\n\t\t\t}\n\t\t} else if (typeof value !== 'function') {\n\t\t\tvar valid = function valid(item) {\n\t\t\t\treturn item == value;\n\t\t\t}\n\t\t}\n\n\t\tfor (var item of this) {\n\t\t\tif (valid(key == null ? item : item[key])) {\n\t\t\t\tfound.add(item);\n\t\t\t}\n\t\t}\n\n\t\treturn found;\n\t}\n\n\tadd(data) {\n\t\tvar cacheKey = data[this[discrimS]];\n\t\tif (this[discrimCacheS][cacheKey]) {\n\t\t\treturn this[discrimCacheS][cacheKey];\n\t\t}\n\t\tif (this.limit && this.length >= this.limit) {\n\t\t\tthis.splice(0, 1);\n\t\t}\n\t\tthis.push(data);\n\t\tthis[discrimCacheS][cacheKey] = data;\n\t\treturn data;\n\t}\n\n\tupdate(old, data) {\n\t\tvar obj = this[discrimCacheS][old[this[discrimS]]];\n        if (obj) {\n\t\t\tfor (var key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tobj[key] = data[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\t\treturn false;\n\t}\n\n\trandom() {\n\t\treturn this[Math.floor(Math.random()*this.length)];\n\t}\n\n\tremove(data) {\n\t\tif(!this[discrimCacheS][data[this[discrimS]]]) return false;\n\n\t\tdelete this[discrimCacheS][data[this[discrimS]]];\n\t\tfor (var i in this) {\n\t\t\tif (this[i] && this[i][this[discrimS]] === data[this[discrimS]]) {\n\t\t\t\tthis.splice(i, 1);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n"]}