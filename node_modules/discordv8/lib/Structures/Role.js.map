{"version":3,"sources":["../../src/Structures/Role.js"],"names":["DefaultRole","createInstantInvite","readMessages","readMessageHistory","sendMessages","sendTTSMessages","embedLinks","attachFiles","mentionEveryone","voiceConnect","voiceSpeak","voiceUseVAD","reduce","previous","current","Role","constructor","data","server","client","position","permissions","name","managed","id","hoist","color","mentionable","createdAt","Date","toObject","keys","obj","k","serialise","explicit","hp","perm","hasPermission","kickMembers","banMembers","manageRoles","manageChannels","manageServer","administrator","manageMessages","voiceMuteMembers","voiceDeafenMembers","voiceMoveMembers","serialize","String","setPermission","permission","value","setPermissions","forEach","colorAsHex","val","toString","length","delete","deleteRole","apply","arguments","edit","updateRole","update","addMember","member","callback","addMemberToRole","addUser","addUserToRole","removeMember","removeMemberFromRole","removeUser","removeUserFromRole","mention"],"mappings":"AAAA;;;;;;AACA;;AACA;;AACA;;;;;;;;;;;;;AAaA,MAAMA,cAAc,CACnB,uBAAYC,mBADO,EAEnB,uBAAYC,YAFO,EAGnB,uBAAYC,kBAHO,EAInB,uBAAYC,YAJO,EAKnB,uBAAYC,eALO,EAMnB,uBAAYC,UANO,EAOnB,uBAAYC,WAPO,EAQnB,uBAAYJ,kBARO,EASnB,uBAAYK,eATO,EAUnB,uBAAYC,YAVO,EAWnB,uBAAYC,UAXO,EAYnB,uBAAYC,WAZO,EAalBC,MAbkB,CAaV,CAACC,QAAD,EAAWC,OAAX,KAAuBD,WAAWC,OAbxB,EAaiC,CAbjC,CAApB;;AAee,MAAMC,IAAN,CAAW;AACzBC,aAAYC,IAAZ,EAAkBC,MAAlB,EAA0BC,MAA1B,EAAiC;AAChC,OAAKC,QAAL,GAAgBH,KAAKG,QAAL,IAAiB,CAAC,CAAlC;AACA,OAAKC,WAAL,GAAmBJ,KAAKI,WAAL,KAAqBJ,KAAKK,IAAL,KAAc,WAAd,GAA4BtB,WAA5B,GAA0C,CAA/D,CAAnB;AACA,OAAKsB,IAAL,GAAYL,KAAKK,IAAL,IAAa,WAAzB;AACA,OAAKC,OAAL,GAAeN,KAAKM,OAAL,IAAgB,KAA/B;AACA,OAAKC,EAAL,GAAUP,KAAKO,EAAf;AACA,OAAKC,KAAL,GAAaR,KAAKQ,KAAL,IAAc,KAA3B;AACA,OAAKC,KAAL,GAAaT,KAAKS,KAAL,IAAc,CAA3B;AACA,OAAKR,MAAL,GAAcA,MAAd;AACA,OAAKC,MAAL,GAAcA,MAAd;AACA,OAAKQ,WAAL,GAAmBV,KAAKU,WAAL,IAAoB,KAAvC;AACA;;AAED,KAAIC,SAAJ,GAAgB;AACf,SAAO,IAAIC,IAAJ,CAAU,CAAC,KAAKL,EAAN,GAAW,OAAZ,GAAuB,aAAhC,CAAP;AACA;;AAEDM,YAAW;AACV,MAAIC,OAAO,CAAC,IAAD,EAAO,UAAP,EAAmB,aAAnB,EAAkC,MAAlC,EAA0C,SAA1C,EAAqD,OAArD,EAA8D,OAA9D,EAAuE,aAAvE,CAAX;AAAA,MACCC,MAAM,EADP;;AAGA,OAAK,IAAIC,CAAT,IAAcF,IAAd,EAAoB;AACnBC,OAAIC,CAAJ,IAAS,KAAKA,CAAL,CAAT;AACA;;AAED,SAAOD,GAAP;AACA;;AAEDE,WAAUC,QAAV,EAAmB;;AAElB,MAAIC,KAAMC,IAAD,IAAU,KAAKC,aAAL,CAAmBD,IAAnB,EAAyBF,QAAzB,CAAnB;;AAEA,SAAO;AACN;AACAlC,wBAAsBmC,GAAI,uBAAYnC,mBAAhB,CAFhB;AAGNsC,gBAAcH,GAAI,uBAAYG,WAAhB,CAHR;AAINC,eAAaJ,GAAI,uBAAYI,UAAhB,CAJP;AAKNC,gBAAcL,GAAK,uBAAYK,WAAjB,CALR;AAMNC,mBAAiBN,GAAI,uBAAYM,cAAhB,CANX;AAONC,iBAAeP,GAAI,uBAAYO,YAAhB,CAPT;AAQNC,kBAAeR,GAAI,uBAAYQ,aAAhB,CART;AASN;AACA1C,iBAAekC,GAAI,uBAAYlC,YAAhB,CAVT;AAWNE,iBAAegC,GAAI,uBAAYhC,YAAhB,CAXT;AAYNC,oBAAkB+B,GAAI,uBAAY/B,eAAhB,CAZZ;AAaNwC,mBAAiBT,GAAI,uBAAYS,cAAhB,CAbX;AAcNvC,eAAa8B,GAAI,uBAAY9B,UAAhB,CAdP;AAeNC,gBAAc6B,GAAI,uBAAY7B,WAAhB,CAfR;AAgBNJ,uBAAqBiC,GAAI,uBAAYjC,kBAAhB,CAhBf;AAiBNK,oBAAkB4B,GAAI,uBAAY5B,eAAhB,CAjBZ;AAkBN;AACAC,iBAAe2B,GAAI,uBAAY3B,YAAhB,CAnBT;AAoBNC,eAAa0B,GAAI,uBAAY1B,UAAhB,CApBP;AAqBNoC,qBAAmBV,GAAI,uBAAYU,gBAAhB,CArBb;AAsBNC,uBAAqBX,GAAI,uBAAYW,kBAAhB,CAtBf;AAuBNC,qBAAmBZ,GAAI,uBAAYY,gBAAhB,CAvBb;AAwBNrC,gBAAcyB,GAAI,uBAAYzB,WAAhB;AAxBR,GAAP;AA0BA;;AAEDsC,aAAW;AACV;AACA,SAAO,KAAKf,SAAL,EAAP;AACA;;AAEDI,eAAcD,IAAd,EAAoBF,WAAS,KAA7B,EAAmC;AAClC,MAAIE,gBAAgBa,MAAhB,IAA0B,OAAOb,IAAP,KAAgB,QAA9C,EAAwD;AACvDA,UAAO,uBAAYA,IAAZ,CAAP;AACA;AACD,MAAG,CAACA,IAAJ,EAAS;AACR,UAAO,KAAP;AACA;AACD,MAAG,CAACF,QAAJ,EAAa;AAAE;AACd,OAAI,CAAC,EAAE,KAAKd,WAAL,GAAmB,uBAAYuB,aAAjC,CAAL,EAAsD;AACrD;AACA,WAAO,IAAP;AACA;AACD;AACD;AACA;AACA;;AAEA,SAAO,CAAC,EAAE,KAAKvB,WAAL,GAAmBgB,IAArB,CAAR;AACA;;AAEDc,eAAcC,UAAd,EAA0BC,KAA1B,EAAgC;AAC/B,MAAID,sBAAsBF,MAAtB,IAAgC,OAAOE,UAAP,KAAsB,QAA1D,EAAoE;AACnEA,gBAAa,uBAAYA,UAAZ,CAAb;AACA;AACD,MAAGA,UAAH,EAAc;AACb;AACA,OAAGC,KAAH,EAAS;AACR,SAAKhC,WAAL,IAAoB+B,UAApB;AACA,IAFD,MAEK;AACJ,SAAK/B,WAAL,IAAoB,CAAC+B,UAArB;AACA;AACD;AACD;;AAEDE,gBAAetB,GAAf,EAAmB;AAClBA,MAAIuB,OAAJ,CAAY,CAACF,KAAD,EAAQD,UAAR,KAAuB;AAClC,OAAIA,sBAAsBF,MAAtB,IAAgC,OAAOE,UAAP,KAAsB,QAA1D,EAAoE;AACnEA,iBAAa,uBAAYA,UAAZ,CAAb;AACA;AACD,OAAGA,UAAH,EAAc;AACb;AACA,SAAKD,aAAL,CAAmBC,UAAnB,EAA+BC,KAA/B;AACA;AACD,GARD;AASA;;AAEDG,cAAY;AACX,MAAIC,MAAM,KAAK/B,KAAL,CAAWgC,QAAX,CAAoB,EAApB,CAAV;AACA,SAAMD,IAAIE,MAAJ,GAAa,CAAnB,EAAqB;AACpBF,SAAM,MAAMA,GAAZ;AACA;AACD,SAAO,MAAIA,GAAX;AACA;;AAEDG,UAAS;AACR,SAAO,KAAKzC,MAAL,CAAY0C,UAAZ,CAAuBC,KAAvB,CAA6B,KAAK3C,MAAlC,EAA0C,8BAAI,IAAJ,EAAU4C,SAAV,CAA1C,CAAP;AACA;;AAEDC,QAAO;AACN,SAAO,KAAK7C,MAAL,CAAY8C,UAAZ,CAAuBH,KAAvB,CAA6B,KAAK3C,MAAlC,EAA0C,8BAAI,IAAJ,EAAU4C,SAAV,CAA1C,CAAP;AACA;;AAEDG,UAAS;AACR,SAAO,KAAK/C,MAAL,CAAY8C,UAAZ,CAAuBH,KAAvB,CAA6B,KAAK3C,MAAlC,EAA0C,8BAAI,IAAJ,EAAU4C,SAAV,CAA1C,CAAP;AACA;;AAEDI,WAAUC,MAAV,EAAkBC,QAAlB,EAA4B;AAC3B,SAAO,KAAKlD,MAAL,CAAYmD,eAAZ,CAA4BR,KAA5B,CAAkC,KAAK3C,MAAvC,EAA+C,CAACiD,MAAD,EAAS,IAAT,EAAeC,QAAf,CAA/C,CAAP;AACA;;AAEDE,SAAQH,MAAR,EAAgBC,QAAhB,EAA0B;AACzB,SAAO,KAAKlD,MAAL,CAAYqD,aAAZ,CAA0BV,KAA1B,CAAgC,KAAK3C,MAArC,EAA6C,CAACiD,MAAD,EAAS,IAAT,EAAeC,QAAf,CAA7C,CAAP;AACA;;AAEDI,cAAaL,MAAb,EAAqBC,QAArB,EAA+B;AAC9B,SAAO,KAAKlD,MAAL,CAAYuD,oBAAZ,CAAiCZ,KAAjC,CAAuC,KAAK3C,MAA5C,EAAoD,CAACiD,MAAD,EAAS,IAAT,EAAeC,QAAf,CAApD,CAAP;AACA;;AAEDM,YAAWP,MAAX,EAAmBC,QAAnB,EAA6B;AAC5B,SAAO,KAAKlD,MAAL,CAAYyD,kBAAZ,CAA+Bd,KAA/B,CAAqC,KAAK3C,MAA1C,EAAkD,CAACiD,MAAD,EAAS,IAAT,EAAeC,QAAf,CAAlD,CAAP;AACA;;AAEDQ,WAAS;AACR,MAAG,KAAKlD,WAAR,EACC,OAAQ,MAAK,KAAKH,EAAG,GAArB;AACD,SAAO,KAAKF,IAAZ;AACA;;AAEDoC,YAAU;AACT,SAAO,KAAKmB,OAAL,EAAP;AACA;AA5JwB;kBAAL9D,I","file":"Role.js","sourcesContent":["\"use strict\";\nimport {Permissions} from \"../Constants\";\nimport {reg} from \"../Util/ArgumentRegulariser\";\n/*\n\nexample data\n\n{ position: -1,\n    permissions: 36953089,\n    name: '@everyone',\n    managed: false,\n    id: '110007368451915776',\n    hoist: false,\n    color: 0 }\n*/\n\nconst DefaultRole = [\n\tPermissions.createInstantInvite,\n\tPermissions.readMessages,\n\tPermissions.readMessageHistory,\n\tPermissions.sendMessages,\n\tPermissions.sendTTSMessages,\n\tPermissions.embedLinks,\n\tPermissions.attachFiles,\n\tPermissions.readMessageHistory,\n\tPermissions.mentionEveryone,\n\tPermissions.voiceConnect,\n\tPermissions.voiceSpeak,\n\tPermissions.voiceUseVAD\n].reduce( (previous, current) => previous | current, 0 );\n\nexport default class Role {\n\tconstructor(data, server, client){\n\t\tthis.position = data.position || -1;\n\t\tthis.permissions = data.permissions || (data.name === \"@everyone\" ? DefaultRole : 0 );\n\t\tthis.name = data.name || \"@everyone\";\n\t\tthis.managed = data.managed || false;\n\t\tthis.id = data.id;\n\t\tthis.hoist = data.hoist || false;\n\t\tthis.color = data.color || 0;\n\t\tthis.server = server;\n\t\tthis.client = client;\n\t\tthis.mentionable = data.mentionable || false;\n\t}\n\n\tget createdAt() {\n\t\treturn new Date((+this.id / 4194304) + 1420070400000);\n\t}\n\n\ttoObject() {\n\t\tlet keys = ['id', 'position', 'permissions', 'name', 'managed', 'hoist', 'color', 'mentionable'],\n\t\t\tobj = {};\n\n\t\tfor (let k of keys) {\n\t\t\tobj[k] = this[k];\n\t\t}\n\t\t\n\t\treturn obj;\n\t}\n\n\tserialise(explicit){\n\n\t\tvar hp = (perm) => this.hasPermission(perm, explicit);\n\n\t\treturn {\n\t\t\t// general\n\t\t\tcreateInstantInvite : hp( Permissions.createInstantInvite ),\n\t\t\tkickMembers : hp( Permissions.kickMembers ),\n\t\t\tbanMembers : hp( Permissions.banMembers ),\n\t\t\tmanageRoles : hp ( Permissions.manageRoles ),\n\t\t\tmanageChannels : hp( Permissions.manageChannels ),\n\t\t\tmanageServer : hp( Permissions.manageServer ),\n\t\t\tadministrator: hp( Permissions.administrator ),\n\t\t\t// text\n\t\t\treadMessages : hp( Permissions.readMessages ),\n\t\t\tsendMessages : hp( Permissions.sendMessages ),\n\t\t\tsendTTSMessages : hp( Permissions.sendTTSMessages ),\n\t\t\tmanageMessages : hp( Permissions.manageMessages ),\n\t\t\tembedLinks : hp( Permissions.embedLinks ),\n\t\t\tattachFiles : hp( Permissions.attachFiles ),\n\t\t\treadMessageHistory : hp( Permissions.readMessageHistory ),\n\t\t\tmentionEveryone : hp( Permissions.mentionEveryone ),\n\t\t\t// voice\n\t\t\tvoiceConnect : hp( Permissions.voiceConnect ),\n\t\t\tvoiceSpeak : hp( Permissions.voiceSpeak ),\n\t\t\tvoiceMuteMembers : hp( Permissions.voiceMuteMembers ),\n\t\t\tvoiceDeafenMembers : hp( Permissions.voiceDeafenMembers ),\n\t\t\tvoiceMoveMembers : hp( Permissions.voiceMoveMembers ),\n\t\t\tvoiceUseVAD : hp( Permissions.voiceUseVAD )\n\t\t};\n\t}\n\n\tserialize(){\n\t\t// ;n;\n\t\treturn this.serialise();\n\t}\n\n\thasPermission(perm, explicit=false){\n\t\tif( perm instanceof String || typeof perm === \"string\" ){\n\t\t\tperm = Permissions[perm];\n\t\t}\n\t\tif(!perm){\n\t\t\treturn false;\n\t\t}\n\t\tif(!explicit){ // implicit permissions allowed\n\t\t\tif( !!(this.permissions & Permissions.administrator) ){\n\t\t\t\t// manageRoles allowed, they have all permissions\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\t// e.g.\n\t\t// !!(36953089 & Permissions.manageRoles) = not allowed to manage roles\n\t\t// !!(36953089 & (1 << 21)) = voice speak allowed\n\n\t\treturn !!(this.permissions & perm);\n\t}\n\n\tsetPermission(permission, value){\n\t\tif( permission instanceof String || typeof permission === \"string\" ){\n\t\t\tpermission = Permissions[permission];\n\t\t}\n\t\tif(permission){\n\t\t\t// valid permission\n\t\t\tif(value){\n\t\t\t\tthis.permissions |= permission;\n\t\t\t}else{\n\t\t\t\tthis.permissions &= ~permission;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPermissions(obj){\n\t\tobj.forEach((value, permission) => {\n\t\t\tif( permission instanceof String || typeof permission === \"string\" ){\n\t\t\t\tpermission = Permissions[permission];\n\t\t\t}\n\t\t\tif(permission){\n\t\t\t\t// valid permission\n\t\t\t\tthis.setPermission(permission, value);\n\t\t\t}\n\t\t});\n\t}\n\n\tcolorAsHex(){\n\t\tvar val = this.color.toString(16);\n\t\twhile(val.length < 6){\n\t\t\tval = \"0\" + val;\n\t\t}\n\t\treturn \"#\"+val;\n\t}\n\n\tdelete() {\n\t\treturn this.client.deleteRole.apply(this.client, reg(this, arguments));\n\t}\n\n\tedit() {\n\t\treturn this.client.updateRole.apply(this.client, reg(this, arguments));\n\t}\n\n\tupdate() {\n\t\treturn this.client.updateRole.apply(this.client, reg(this, arguments));\n\t}\n\n\taddMember(member, callback) {\n\t\treturn this.client.addMemberToRole.apply(this.client, [member, this, callback]);\n\t}\n\n\taddUser(member, callback) {\n\t\treturn this.client.addUserToRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tremoveMember(member, callback) {\n\t\treturn this.client.removeMemberFromRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tremoveUser(member, callback) {\n\t\treturn this.client.removeUserFromRole.apply(this.client, [member, this, callback]);\n\t}\n\n\tmention(){\n\t\tif(this.mentionable)\n\t\t\treturn `<@&${this.id}>`;\n\t\treturn this.name;\n\t}\n\n\ttoString(){\n\t\treturn this.mention();\n\t}\n}\n"]}